<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LAKSHMI ID MAKER</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="style.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js" defer></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js" defer></script>

    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#121a2e" />
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="icons/icon-512.png" />
</head>

<body>
    <div id="splash-screen">
        <img src="https://i.ibb.co/r2zt8CRQ/Penport-logo-03.png" alt="Lakshmi ID Maker Logo" class="splash-logo">
    </div>

    <div class="app-container">
        <header>
            <img src="https://i.ibb.co/SXrBKWmC/Lakshmi.png" alt="Company Logo" class="logo" />
            <div class="header-text">
                <h1>LAKSHMI ID MAKER</h1>
                <p>Your Trusted Partner For ID Solutions</p>
            </div>
        </header>

        <section id="loginPage" class="main-card" aria-labelledby="loginHeading">
            <h2 id="loginHeading"><i class="fas fa-lock me-2"></i> Login</h2>
            <div class="form-group">
                <label for="loginUser">User ID</label>
                <input type="text" id="loginUser" placeholder="Enter your User ID Or Phone Number" autocomplete="username" />
            </div>
            <div class="form-group">
                <label for="loginPass">Password</label>
                <input type="password" id="loginPass" placeholder="Enter your password" autocomplete="current-password" />
            </div>
            <button type="button" onclick="verifyLogin()" class="btn">Login</button>
        </section>

        <section id="homePage" class="main-card hidden" aria-labelledby="homeHeading">
            <h2 id="homeHeading"><i class="fas fa-id-card-alt me-2"></i> Start Creating Your ID</h2>
            <div class="form-group">
                <label for="schoolName">School Name</label>
                <select id="schoolName" disabled>
                    <option>Auto-filled...</option>
                </select>
            </div>
            <div class="form-group">
                <label for="idType">ID Type</label>
                <select id="idType">
                    <option value="">Select type</option>
                    <option value="student">Student</option>
                    <option value="staff">Staff</option>
                </select>
            </div>
            <button type="button" onclick="navigateToForm()" class="btn">Continue</button>
        </section>

        <section id="idForm" class="main-card hidden" aria-labelledby="formHeading">
            <h2 id="formHeading"><i class="fas fa-clipboard me-2"></i> Fill ID Form</h2>
            <form id="dataForm" onsubmit="handleSubmit(event)">
                <div id="formFields">
                    </div>

                <div class="media-container" style="margin-bottom: 20px;">
                    <video id="video" autoplay playsinline muted class="hidden"></video>
                    <canvas id="canvas" class="hidden"></canvas>
                </div>

                <div class="btn-group">
                    <button id="cameraBtn" type="button" onclick="startCamera()" class="icon-btn camera-btn" title="Start Camera">
                        <i class="fas fa-video"></i>
                        <span>Camera</span>
                    </button>
                    <button id="submitBtn" type="submit" class="icon-btn submit-btn" title="Submit">
                        <i class="fas fa-paper-plane"></i>
                        <span>Submit</span>
                    </button>
                    <button id="homeBtn" type="button" onclick="goHome()" class="icon-btn home-btn" title="Go to Home">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </button>
                </div>
            </form>
        </section>

        <section id="previewPage" class="main-card hidden" aria-labelledby="previewHeading">
            <h2 id="previewHeading"><i class="fas fa-image me-2"></i> Preview</h2>
            <div id="preview" style="margin-bottom: 20px;"></div>

            <div id="progressContainer" class="progress-container">
                <div id="uploadProgress" class="progress-bar"></div>
            </div>

            <div class="btn-group">
                <button onclick="saveIDAsImage()" class="icon-btn save-btn" title="Save as Image">
                    <i class="fas fa-download"></i>
                    <span>Save</span>
                </button>
                <button onclick="editEntry()" class="icon-btn edit-btn" title="Edit Entry">
                    <i class="fas fa-pen"></i>
                    <span>Edit</span>
                </button>
                <button id="newEntryBtn" onclick="newEntry()" class="icon-btn new-btn" title="Create New ID">
                    <i class="fas fa-plus"></i>
                    <span>New ID</span>
                </button>
            </div>
        </section>
    </div>

    <div id="messageModal" class="modal-container" aria-modal="true" role="dialog">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="modal-body">
                <div class="modal-icon">
                    </div>
                <h3 id="modalTitle"></h3>
                <p id="modalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="modalOkBtn" class="btn">OK</button>
            </div>
        </div>
    </div>

    <footer>
        <span>POWERED BY <a href="https://penportindia.github.io/penport/" target="_blank">Penport India</a> Â© 2025</span>
    </footer>

    <script type="module" src="main.js"></script>
    <script>
        // Splash Screen Logic
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const splashScreen = document.getElementById('splash-screen');
                splashScreen.classList.add('fade-out');

                setTimeout(() => {
                    splashScreen.remove();
                }, 500);
            }, 3000);
        });

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('Service Worker registered:', reg.scope))
                    .catch(err => console.error('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>
